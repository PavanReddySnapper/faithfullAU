import{r as F}from"./theme-sections-ecef3d83.js";import{F as b}from"./index-13f72e9f.js";import"./flickity-imagesloaded-2e68b949.js";import{i as C}from"./flickity-cae15e9c.js";const a={sliderContainer:"[data-slider-container]",slide:"[data-slide]",carouselControls:"[data-carousel-controls]",recommendationsContainer:"[data-recommendations-container]",recommendationsSliderContainer:"[data-recommendations-slider-container]",recommendationsControls:"[data-recommendations-controls]",recommendationsPrevButton:"[data-recommendations-controls] [data-prev-btn]",recommendationsNextButton:"[data-recommendations-controls] [data-next-btn]",recentlyViewedSliderContainer:"[data-recently-viewed-slider-container]",recentlyViewedControls:"[data-recently-viewed-controls]",recentlyViewedPrevButton:"[data-recently-viewed-controls] [data-prev-btn]",recentlyViewedNextButton:"[data-recently-viewed-controls] [data-next-btn]",recentlyViewedCard:"[data-product-card-recently-viewed]",tabs:".js-tabs",tablistLink:"[data-tab-link]",tablistLinkActive:'[data-tab-link][aria-selected="true"]'},V={recommendations:"Recommendations",recentlyViewed:"RecentlyViewed"},h={hide:"hide"},E="product-recently-viewed-recommendations";var N,P,x;const $=((x=(P=(N=window.Shopify)==null?void 0:N.theme)==null?void 0:P.sections)==null?void 0:x.registered)||{},H=typeof $[E]>"u";H&&F(E,{async onLoad(){const t=this.container,w=t.dataset.productHandle,S=Number(t.dataset.limit),T=t.dataset.slideClass,I=t.dataset.url,d=t.querySelector(a.recentlyViewedControls),m=t.querySelector(a.recommendationsControls),R=async()=>{const i=await fetch(I);if(!i.ok)return;const s=await i.text(),n=document.createRange().createContextualFragment(s),o=n==null?void 0:n.querySelector(a.recommendationsSliderContainer);if(!o)return;const l=t.querySelector(a.recommendationsContainer);"replaceChildren"in HTMLElement.prototype?l.replaceChildren(o):(l.childNodes.forEach(u=>u.remove()),l.appendChild(o));const y=l.querySelector(a.recommendationsSliderContainer),c=y==null?void 0:y.querySelectorAll(a.slide);if((c==null?void 0:c.length)<3)return;const e=t.querySelector(a.recommendationsPrevButton),r=t.querySelector(a.recommendationsNextButton);C(),new b(y,{prevNextButtons:!1,pageDots:!1,cellAlign:"left",watchCSS:!0,contain:!0,on:{ready(){e==null||e.addEventListener("click",()=>this.previous(!1,!1)),r==null||r.addEventListener("click",()=>this.next(!1,!1)),e==null||e.setAttribute("disabled","")},change(){e==null||e.removeAttribute("disabled"),r==null||r.removeAttribute("disabled"),this.slides[this.selectedIndex-1]?c!=null&&c[this.selectedIndex+1]||r==null||r.setAttribute("disabled",""):e==null||e.setAttribute("disabled","")}}})},M=async()=>{var u,p,v,A;const i=t.querySelector(a.recentlyViewedSliderContainer);if(!i)return;const n=(JSON.parse(localStorage.getItem("recently_viewed_products"))||[]).filter(f=>f!==w);if(n.unshift(w),n.length=Math.min(n.length,S*2),localStorage.setItem("recently_viewed_products",JSON.stringify(n)),n.length===1)return;const o=(p=(u=window.theme)==null?void 0:u.locale)!=null&&p.primary?"":(A=(v=window.theme)==null?void 0:v.locale)==null?void 0:A.rootUrl,l=[];for(const f of n.slice(1)){if(l.length===S)break;try{const q=`${o}/products/${f}?view=recently-viewed`,L=await fetch(q);if(!L.ok)continue;const k=await L.text();if(!new DOMParser().parseFromString(k,"text/html").querySelector(a.recentlyViewedCard))continue;l.push(k)}catch{window.console.error(`Recently viewed product does not exist: ${f}`)}}if(l.length===0)return;const y=l.join("");i.innerHTML=y,t.classList.remove(h.hide);const c=i==null?void 0:i.querySelectorAll(a.slide);if(c.forEach(f=>f.classList.add(T)),(c==null?void 0:c.length)<3)return;const e=t.querySelector(a.recentlyViewedPrevButton),r=t.querySelector(a.recentlyViewedNextButton);C(),new b(i,{freeScroll:!1,prevNextButtons:!1,pageDots:!1,imagesLoaded:!0,setGallerySize:!0,cellAlign:"left",watchCSS:!0,contain:!0,on:{ready(){e==null||e.addEventListener("click",()=>this.previous(!1,!1)),r==null||r.addEventListener("click",()=>this.next(!1,!1)),e==null||e.setAttribute("disabled","")},change(){e==null||e.removeAttribute("disabled"),r==null||r.removeAttribute("disabled"),this.slides[this.selectedIndex-1]?c!=null&&c[this.selectedIndex+1]||r==null||r.setAttribute("disabled",""):e==null||e.setAttribute("disabled","")}}})},g=(i,s)=>{if(!i||!s)return;i===V.recentlyViewed?(m==null||m.classList.add(h.hide),d==null||d.classList.remove(h.hide)):i===V.recommendations&&(m==null||m.classList.remove(h.hide),d==null||d.classList.add(h.hide));const n=s.querySelector(a.sliderContainer);if(!n)return;const o=b.data(n);o==null||o.resize()},D=()=>{const i=t.querySelector(a.tablistLinkActive);if(i){const s=i.getAttribute("aria-controls"),n=t.querySelector(`#${s}`);g(s,n)}if(t.querySelectorAll(a.tablistLink).forEach(s=>{s.addEventListener("click",()=>{const n=s.getAttribute("aria-controls"),o=t.querySelector(`#${n}`);g(n,o)})}),Shopify.designMode){const s=t.querySelector(a.tabs);s&&!s.id&&van11yAccessibleTabPanelAria(t)}};await Promise.allSettled([R(),M()]),D()}});

import{r as h}from"./theme-sections-ecef3d83.js";import{i as f}from"./gift-card-value-selector-a485e736.js";import{i as v}from"./accordions-f19b9140.js";import"./currency-7d20dcfe.js";const g="main-product-gift-card";var p,u,m;const b=((m=(u=(p=window.Shopify)==null?void 0:p.theme)==null?void 0:u.sections)==null?void 0:m.registered)||{},y=typeof b[g]>"u",l={hide:"hide"},n={productForm:"[data-product-form]",recipientField:"[data-recipient-field]",image:{container:"[data-gift-card-image]",title:"[data-gift-card-image-title]",recipient:"[data-gift-card-image-recipient]",message:"[data-gift-card-image-message]"},options:{group:"[data-option-group]",image:"[data-gift-card-image-option]",nextButton:"[data-next-button]"},accordion:{panel:".accordion__panel",trigger:".accordion__trigger"}};y&&h(g,{onLoad(){this.initOptionGroups(),this.initRecipientFields(),this.initAppearanceOptions(),this.initProductForm(),v(this.container)},initOptionGroups(){this.container.querySelectorAll(n.options.group).forEach(e=>{const r=e.querySelector(n.options.nextButton);if(!r)return;r.addEventListener("click",this.openNextPanel.bind(this));const t=e.querySelectorAll("[required]");if(!t.length){r==null||r.removeAttribute("disabled");return}e.addEventListener("keypress",this.validateOptionGroup.bind(this,{requiredFields:t,nextButton:r})),e.addEventListener("change",this.validateOptionGroup.bind(this,{requiredFields:t,nextButton:r}));const a=e.closest(n.accordion.panel),o=this.container.querySelector(`[aria-controls="${a.id}"]`);t.forEach(s=>{s.addEventListener("focus",()=>{o.getAttribute("aria-expanded")!=="true"&&o.click()})})})},validateOptionGroup({requiredFields:i,nextButton:e}){[...i].every(t=>t.value!=="")?e.removeAttribute("disabled"):e.setAttribute("disabled","")},openNextPanel(){var r;event.preventDefault();const e=(r=event.target.closest(n.accordion.panel).nextElementSibling)==null?void 0:r.querySelector(n.accordion.trigger);e&&e.click()},initAppearanceOptions(){const i=document.querySelectorAll(n.options.image),e=this.container.querySelector(n.image.container);!i.length||!e||i.forEach(r=>{r.addEventListener("change",t=>{const a=t.target.dataset.image;e.style.backgroundImage=`url(${a})`})})},initRecipientFields(){const i=this.container.querySelectorAll(n.recipientField);i.length&&i.forEach(e=>{this.updateCardPreview.bind(this,e),e.addEventListener("change",this.updateCardPreview.bind(this,e)),e.addEventListener("keyup",this.updateCardPreview.bind(this,e)),e.addEventListener("cut",this.updateCardPreview.bind(this,e))})},updateCardPreview(i){const e=i.value,r=i.name.match(/\[(.*)\]/)[1];if(!r)return;const t=this.container.querySelector(`[data-gift-card-text="${r.toLowerCase()}"]`);t&&(e===""?t.classList.add(l.hide):t.classList.remove(l.hide),t.innerText=e)},initProductForm(){this.container.querySelector(n.productForm).addEventListener("submit",this.onFormSubmit.bind(this)),f()},getFormData(i){const e=Object.fromEntries(i.entries()),r=Object.entries(e).reduce((t,[a,o])=>{const s=a.match(/(.*)\[(.*)\]/);if(!s)return t;const[,d,c]=s;return!d||!c||(t[d]||(t[d]={}),t[d][c]=o),t},{});return{id:parseInt(e.id,10),quantity:1,...r}},onFormSubmit(i){i.preventDefault();const e=this.getFormData(new FormData(i.target));e.id&&window.sideCart.handleAddToCartEvent(e,!0)}});
